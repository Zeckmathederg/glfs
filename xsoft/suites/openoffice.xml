<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE sect1 PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
   "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
  <!ENTITY % general-entities SYSTEM "../../general.ent">
  %general-entities;

  <!-- <!ENTITY openoffice-download-http "http://download.openoffice.org/&openoffice-version;/source.html"> -->
  <!-- <!ENTITY openoffice-download-ftp  "ftp://ftp.ussg.iu.edu/pub/openoffice/stable/&openoffice-version;/OOo_&openoffice-version;_src.tar.gz"> -->
  <!ENTITY openoffice-core-download-http   "http://ftp.osuosl.org/pub/openoffice/stable/&openoffice-version;/OOo_&openoffice-version;_src_core.tar.bz2">
  <!ENTITY openoffice-core-download-ftp    "ftp://ftp.osuosl.org/pub/openoffice/stable/&openoffice-version;/OOo_&openoffice-version;_src_core.tar.bz2">
  <!ENTITY openoffice-core-md5sum          "9555a2d5fae9a25c788cc732921ef57a">
  <!ENTITY openoffice-core-size            "138 MB">
  <!ENTITY openoffice-system-download-http "http://ftp.osuosl.org/pub/openoffice/stable/&openoffice-version;/OOo_&openoffice-version;_src_system.tar.bz2">
  <!ENTITY openoffice-system-download-ftp  "ftp://ftp.osuosl.org/pub/openoffice/stable/&openoffice-version;/OOo_&openoffice-version;_src_system.tar.bz2">
  <!ENTITY openoffice-system-md5sum        "1e20befe2fdb65c00be11f1f5d9ebdca">
  <!ENTITY openoffice-system-size          "36 MB">
  <!ENTITY openoffice-buildsize            "4.2-4.8 GB (depending on configured options)">
  <!ENTITY openoffice-time                 "75-100 SBU (depending on configured options)">
]>

<sect1 id="openoffice" xreflabel="OpenOffice-&openoffice-version;">
  <?dbhtml filename="openoffice.html" ?>

  <sect1info>
    <othername>$LastChangedBy$</othername>
    <date>$Date$</date>
  </sect1info>

  <title>OpenOffice-&openoffice-version;</title>

  <indexterm zone="openoffice">
    <primary sortas="a-OpenOffice">OpenOffice</primary>
  </indexterm>

  <sect2 role="package">
    <title>Introduction to OpenOffice</title>

    <para><application>OpenOffice</application> is an office suite, the
    open source sibling of <application>StarOffice</application>.</para>

    <bridgehead renderas="sect3">Package Information</bridgehead>
    <itemizedlist spacing="compact">
      <listitem>
        <para>OpenOffice Core Download (HTTP): <ulink url="&openoffice-core-download-http;"/></para>
      </listitem>
      <listitem>
        <para>OpenOffice Core Download (FTP): <ulink url="&openoffice-core-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>OpenOffice Core Download MD5 sum: &openoffice-core-md5sum;</para>
      </listitem>
      <listitem>
        <para>OpenOffice Core Download size: &openoffice-core-size;</para>
      </listitem>
      <listitem>
        <para>OpenOffice System Download (HTTP): <ulink url="&openoffice-system-download-http;"/></para>
      </listitem>
      <listitem>
        <para>OpenOffice System Download (FTP): <ulink url="&openoffice-system-download-ftp;"/></para>
      </listitem>
      <listitem>
        <para>OpenOffice System Download MD5 sum: &openoffice-system-md5sum;</para>
      </listitem>
      <listitem>
        <para>OpenOffice System Download size: &openoffice-system-size;</para>
      </listitem>
      <listitem>
        <para>Estimated disk space required: &openoffice-buildsize;</para>
      </listitem>
      <listitem>
        <para>Estimated build time: &openoffice-time;</para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">Additional Downloads</bridgehead>
    <itemizedlist spacing='compact'>
      <listitem>
        <para>Required patch:
        <ulink url="&patch-root;/OOo_&openoffice-version;-use_bin_hsqldb-1.patch"/>
        </para>
      </listitem>
      <listitem>
        <para>Optional download if you wish to build the in-tree
        <application>Mozilla</application> browser:
        <ulink url="ftp://ftp.mozilla.org/pub/mozilla.org/mozilla/releases/mozilla1.7.5/source/mozilla-source-1.7.5.tar.gz"/></para>
      </listitem>
      <listitem>
        <para>Optional download if you wish to build the
        <application>OpenOffice</application> SDK:
        <ulink url="ftp://ftp.osuosl.org/pub/openoffice/stable/&openoffice-version;/OOo_&openoffice-version;_src_sdk.tar.bz2"/>
        which also requires <ulink url="http://www.mingw.org/">MinGW</ulink>
        or a precompiled <filename>unowinreg.dll</filename> for the
        cross-platform <application>Java</application> components.</para>
      </listitem>
      <listitem>
        <para>Optional download if you would like to localize the
        installation:
        <ulink url="ftp://ftp.osuosl.org/pub/openoffice/stable/&openoffice-version;/OOo_&openoffice-version;_src_l10n.tar.bz2"/></para>
      </listitem>
      <listitem>
        <para>Optional download if you need to support the old
        <application>StarOffice-5.x</application> file formats:
        <ulink url="ftp://ftp.osuosl.org/pub/openoffice/stable/&openoffice-version;/OOo_&openoffice-version;_src_binfilter.tar.bz2"/></para>
      </listitem>
    </itemizedlist>

    <bridgehead renderas="sect3">OpenOffice Dependencies</bridgehead>

    <bridgehead renderas="sect4">Required</bridgehead>
    <para role="required"><xref linkend="apache-ant"/>,
    <xref linkend="gtk2"/>,
    <xref linkend="libidl"/>,
    <application>Perl Modules</application>
    <xref linkend="perl-xml-parser"/> and
    <xref linkend="perl-archive-zip"/>,
    <xref linkend="unzip"/>,
    <xref linkend="which"/>, and
    <xref linkend="zip"/></para>

    <bridgehead renderas="sect4">Recommended</bridgehead>
    <para role="recommended"><xref linkend="libart_lgpl"/> and
    <xref linkend="libxslt"/></para>

    <bridgehead renderas="sect4">Optional</bridgehead>
    <para role="optional"><ulink
    url="http://packages.debian.org/testing/libdevel/libaltlinuxhyph-dev">ALTLinuxhyph</ulink>,
    <ulink url="http://boost.sourceforge.net/">boost</ulink>,
    <xref linkend="cups"/>,
    <xref linkend="curl"/>,
    <xref linkend="db"/> (built with Java support),
    <xref linkend="desktop-file-utils"/>,
    <ulink url="http://www.easysw.com/epm/">EPM</ulink>,
    <xref linkend="evolution"/>,
    <xref linkend="gnome-vfs"/>,
    <ulink url="http://www.cs.man.ac.uk/~toby/alan/software/">GPC</ulink>,
    <xref linkend="kde"/>,
    <xref linkend="libjpeg"/>,
    <ulink url="http://www.mega-nerd.com/libsndfile/">libsndfile</ulink>,
    <xref linkend="libtiff"/>,
    <ulink url="http://freshmeat.net/projects/libwpd/">libwpd</ulink>,
    <xref linkend="linux-pam"/>,
    <xref linkend="firefox"/> (with ldap support),
    <ulink url="http://lingucomponent.openoffice.org/MySpell-3.zip">MySpell</ulink>,
    <ulink url="http://lingucomponent.openoffice.org/thesaurus.html">MyThes</ulink>,
    <xref linkend="nas"/>,
    <ulink url="http://www.webdav.org/neon/">neon</ulink>,
    <xref linkend="openldap"/>,
    <ulink url="http://www.portaudio.com/">PortAudio</ulink>,
    <xref linkend="python"/>,
    <ulink url="http://www.gingerall.com/charlie/ga/xml/p_sab.xml">Sablotron</ulink>,
    <xref linkend="sane"/>,
    <xref linkend="startup-notification"/>,
    <ulink url="http://sourceforge.net/projects/stlport/">STLPort</ulink>, and
    <xref linkend="unixodbc"/></para>

    <para condition="html" role="usernotes">User Notes:
    <ulink url="&blfs-wiki;/openoffice"/></para>

  </sect2>

  <sect2 role="installation">
    <title>Installation of OpenOffice</title>

    <para>The <application>OpenOffice</application> source code is now
    distributed in several tarballs.  You should extract each from the
    same top-level directory before entering the build directory.  At
    a minimum, you will need to extract the <quote>core</quote> and
    <quote>system</quote> tarballs. Note that the source directory name
    is not consistent with the tarball name and will be named
    <filename class='directory'>OOG680_m9</filename>.</para>

    <para>If you wish to build an in-tree <application>Mozilla</application>,
    as opposed to using a system wide installation, copy the
    <application>Mozilla</application> source tarball into the source
    tree:</para>

<screen><userinput>cp ../mozilla-source-1.7.5.tar.gz moz/download/</userinput></screen>

    <para>If you want to optimize the build, edit the appropriate makefile in
    <filename>solenv/inc/</filename> and add the desired optimization
    flags to the <envar>CFLAGSOPT</envar> variable. The makefiles are arch
    specific, for instance edit <filename>solenv/inc/unxlngi6.mk</filename>
    for i686.  Some users have reported problems with
    <option>-fomit-frame-pointer</option>. The best option is to not use any
    custom optimizations.</para>

    <note>
      <para>Because of the complexity of the
      <application>OpenOffice</application> build system, it is not possible to
      provide generic build instructions for all systems.  You should review
      the output of <command>config_office/configure --help</command> and take
      advantage of any system installed programs and libraries available using
      the <parameter>--enable-*</parameter>, <parameter>--disable-*</parameter>,
      and <parameter>--with-system-*</parameter> parameters.  Additionally, if
      you have installed <application>KDE</application> in the
      <filename class='directory'>/opt</filename> prefix, and would like to use
      the <parameter>--enable-kde</parameter> switch, you must set
      <command>KDEDIR=$KDE_PREFIX</command> before running
      <command>configure</command>.</para>
    </note>

    <para><application>OpenOffice</application> fails to compile if
    <command>umask</command> is set to something exotic. The build can also
    fail if the <envar>LANG</envar> or <envar>LC_ALL</envar> environment
    variables are set. Use the following commands to change your
    environment accordingly:</para>

<screen><userinput>umask 0022 &amp;&amp;
unset LANG LC_ALL</userinput></screen>

    <para>Install <application>OpenOffice</application> by running the
    following commands:</para>

<screen><userinput>patch -Np1 -i ../OOo_&openoffice-version;-use_bin_hsqldb-1.patch &amp;&amp;

sed -i 's@..$/dist$/configure@uudecode="no" &amp;@' \
    berkeleydb/makefile.mk &amp;&amp;

pushd config_office &amp;&amp;
./configure --prefix=/opt/openoffice-&openoffice-version; \
            --enable-libart                \
            --disable-fontooo              \
            --disable-gnome-vfs            \
            --without-fonts                \
            --without-system-jars          \
            --without-pam                  \
            --with-system-stdlibs          \
            --with-system-freetype         \
            --with-system-expat            \
            --with-system-libxml           \
            --with-system-libxslt          \
            --with-system-zlib             \
            --enable-cairo                 \
            --enable-build-mozilla         \
            --with-build-version=BLFS      \
            --with-package-format=native   \
            --disable-binfilter            \
            --disable-odk                  \
            --disable-qadevooo             \
            --with-use-shell=bash &amp;&amp;
popd &amp;&amp;

./bootstrap &amp;&amp;
source LinuxX86Env.Set.sh &amp;&amp;
dmake</userinput></screen>

    <para>This package does not come with a test suite.</para>

    <para>Now, as the <systemitem class="username">root</systemitem>
     user:</para>

<screen role="root"><userinput>pushd instsetoo_native/unxlngi6.pro/OpenOffice/\
native/install/en-US/linux-2.6-intel/buildroot/opt &amp;&amp;
cp -r -v openoffice.org2.3 /opt/openoffice-&openoffice-version; &amp;&amp;
popd &amp;&amp;

for appl in sbase scalc sdraw simpress smath soffice spadmin swriter
do
    ln -v -sf /opt/openoffice-&openoffice-version;/program/$appl /usr/bin
done &amp;&amp;

pushd sysui/desktop/icons &amp;&amp;
install -v -m755 -d /usr/share/icons/{HighContrast,hicolor,locolor} &amp;&amp;
cp -r -v HighContrast/*x* /usr/share/icons/HighContrast &amp;&amp;
cp -r -v hicolor/*x*      /usr/share/icons/hicolor &amp;&amp;
cp -r -v locolor/*x*      /usr/share/icons/locolor &amp;&amp;
popd</userinput></screen>

    <para>If you have installed <xref linkend="desktop-file-utils"/>, you
    should copy the <filename class='extension'>*.desktop</filename> files to
    <filename class='directory'>/usr/share/applications</filename> using the
    following commands as the <systemitem class="username">root</systemitem>
    user:</para>

<screen role="root"><userinput>install -v -d -m755 /usr/share/applications &amp;&amp;
pushd /opt/openoffice-&openoffice-version;/share/xdg/ &amp;&amp;
for appl in *.desktop
do
    sed -i '/Exec/d' $appl &amp;&amp;
    echo "Exec=/usr/bin/s`echo $appl | sed 's/.desktop//'`" >> $appl &amp;&amp;
    sed -i '/Icon/d' $appl &amp;&amp;
    echo "Icon=`echo $appl | sed 's/.desktop//'`" >> $appl
done &amp;&amp;
sed -i 's@bin/sprinteradmin@bin/spadmin@' printeradmin.desktop &amp;&amp;
cp -v *.desktop /usr/share/applications &amp;&amp;
update-desktop-database &amp;&amp;
popd</userinput></screen>

    <para>Finally, if you'd like to edit <application>OpenOffice</application>
    documents directly from <xref linkend="seamonkey"/> or
    <xref linkend="firefox"/>, create a symbolic link in your
    plugins directory to <filename
    class='libraryfile'>/opt/openoffice-&openoffice-version;/program/libnpsoplugin.so</filename>.
    Additionally, you must enable the plugin from the
    <parameter>Internet Options</parameter> within any
    <application>OpenOffice</application> application.</para>

  </sect2>

  <sect2 role="commands">
    <title>Command Explanations</title>

    <para><command>sed 's@..\$dist\$/configure@uudecode="no"...'</command>:
    This command corrects a build failure if a faulty
    <command>uudecode</command> program provided by the <xref linkend="gmime"/>
    package is installed.</para>

    <para><parameter>--enable-*</parameter>: The switches listed in the
    example <command>configure</command> command above force the use of system
    installed libraries that are known to be available on a BLFS system that
    meets the required and recommended dependencies.</para>

    <para><parameter>--disable-fontooo</parameter>: Use
    <application>Fontconfig</application> instead of the FontOOo.</para>

    <para><parameter>--disable-gnome-vfs</parameter>: Disable the use of
    <application>Gnome Virtual File System</application> libraries.  Omit
    this switch if you have Gnome installed.</para>

    <para><parameter>--without-fonts</parameter>: Do not install Bitstream
    Vera fonts since they are already included in the
    <application>X</application> Window System Environment.</para>

    <para><parameter>--with{,out}-system-*</parameter>: Determines
    whether to use the system libraries and programs or to build
    the source packages included in the build tree.</para>

    <para><parameter>--without-pam</parameter>: Disable the use of
    <application>Linux-PAM</application> functions.  Omit this switch if
    <application>Linux-PAM</application> is installed.</para>

    <para><parameter>--enable-build-mozilla</parameter>: Build the in-tree
    <application>Mozilla</application> suite.</para>

    <para><parameter>--with-build-version=BLFS</parameter>: Appends
    <quote>BLFS</quote> to the end of the version string.</para>

    <para><parameter>--with-package-format=native</parameter>: This switch
    forces the build to skip the packaging process, leaving only the
    temporary installation that would be used for packaging.  This temporary
    installation is later copied directly to the final destination.</para>

    <para><parameter>--disable-binfilter</parameter>: This switch disables
    the build of legacy <application>StarOffice-5</application> import
    filters.  Omit this switch if you've downloaded the
    <application>binfilter</application> package
    above.  Warning: Installation of the legacy import filters increases the
    build time considerably.  Only install them if you have these old
    file types, and need to edit them in
    <application>OpenOffice</application>.</para>

    <para><parameter>--disable-odk</parameter>: This switch disables the build
    of the <application>OpenOffice</application> SDK.  Omit this switch if
    you've downloaded the SDK package (and additional requirements)
    above.</para>

    <para><parameter>--disable-qadevooo</parameter>: This switch skips
    the building of the quality assurance tools used by the
    <application>OpenOffice</application> development teams.</para>

    <para>
    <parameter>--with-system-mozilla=<replaceable>&lt;type&gt;</replaceable>
    </parameter>: Enables the use of a system installed
    <application>gecko</application> or <application>XULRunner</application>
    engine in place of the full <application>Mozilla</application> suite.
    This will disable the use of a <application>Thunderbird</application>
    address book as a data source.  If you omit the type of installation,
    <command>configure</command> defaults to and searches for a working
    <application>XULRunner</application> installation and will fail if
    one is not found.</para>

    <para><parameter>--disable-cups</parameter>: Disable the use of
    <application>CUPS</application> for printing.</para>

    <para>
    <parameter>--with-lang=<replaceable>&lt;LANG&gt;</replaceable></parameter>:
    Allows the use of additional languages in
    <application>OpenOffice</application>. US English (ENUS) is the
    default.</para>

    <para>
    <parameter>--with-dict=<replaceable>&lt;LANG&gt;</replaceable></parameter>:
    Allows the use of alternate dictionaries in
    <application>OpenOffice</application>. US English (ENUS) is the
    default.</para>

    <para><parameter>--with-use-shell=bash</parameter>: Tells the
    <application>OpenOffice</application> build system to use
    <command>bash</command> instead of <command>tcsh</command>.</para>

    <para><command>./bootstrap</command>: Build the
    <command>dmake</command> utility required to complete the
    build.</para>

    <para><command>dmake</command>: Compiles the package.</para>

    <para><command>for appl in sbase scalc...</command>: Creates symlinks
    for the applications in
    <filename class="directory">/usr/bin</filename>.</para>

    <para><command>for appl in *.desktop...</command>: Edit the
    <filename>*.desktop</filename> files for use with a standard BLFS
    system.</para>

  </sect2>

  <sect2 role="content">
    <title>Contents</title>

    <segmentedlist>
      <segtitle>Installed Programs</segtitle>
      <segtitle>Installed Libraries</segtitle>
      <segtitle>Installed Directory</segtitle>

      <seglistitem>
        <seg>sbase, scalc, sdraw, simpress, smath, soffice, spadmin,
        and swriter</seg>
        <seg><application>OpenOffice</application> libraries</seg>
        <seg>/opt/openoffice-&openoffice-version;</seg>
      </seglistitem>
    </segmentedlist>

    <variablelist>
      <bridgehead renderas="sect3">Short Descriptions</bridgehead>
      <?dbfo list-presentation="list"?>
      <?dbhtml list-presentation="table"?>

      <varlistentry id="sbase">
        <term><command>sbase</command></term>
        <listitem>
          <para>is a database application.</para>
          <indexterm zone="openoffice sbase">
            <primary sortas="b-sbase">sbase</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="scalc">
        <term><command>scalc</command></term>
        <listitem>
          <para>is a spreadsheet application.</para>
          <indexterm zone="openoffice scalc">
            <primary sortas="b-scalc">scalc</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="sdraw">
        <term><command>sdraw</command></term>
        <listitem>
          <para>is a drawing application.</para>
          <indexterm zone="openoffice sdraw">
            <primary sortas="b-sdraw">sdraw</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="simpress">
        <term><command>simpress</command></term>
        <listitem>
          <para>is a presentation application.</para>
          <indexterm zone="openoffice simpress">
            <primary sortas="b-simpress">simpress</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="smath">
        <term><command>smath</command></term>
        <listitem>
          <para>is a mathematical formula editor.</para>
          <indexterm zone="openoffice smath">
            <primary sortas="b-smath">smath</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="soffice">
        <term><command>soffice</command></term>
        <listitem>
          <para>opens a base window with access to all
          <application>OpenOffice</application> applications.</para>
          <indexterm zone="openoffice soffice">
            <primary sortas="b-soffice">soffice</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="spadmin">
        <term><command>spadmin</command></term>
        <listitem>
          <para>is the <application>OpenOffice</application> printer
          configuration utility.</para>
          <indexterm zone="openoffice spadmin">
            <primary sortas="b-spadmin">spadmin</primary>
          </indexterm>
        </listitem>
      </varlistentry>

      <varlistentry id="swriter">
        <term><command>swriter</command></term>
        <listitem>
          <para>is a word processing application.</para>
          <indexterm zone="openoffice swriter">
            <primary sortas="b-swriter">swriter</primary>
          </indexterm>
        </listitem>
      </varlistentry>

    </variablelist>

  </sect2>

</sect1>
